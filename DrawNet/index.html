<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description"
    content="Probably the most complete UI kit out there. Multiple functionalities and controls added,  extended color palette and beautiful typography, designed as its own extended version of Bootstrap at  the highest level of quality.                             ">
  <meta name="author" content="Webpixels">
  <title>DrawNet: A neural painting network with attention module</title>
  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css?family=Nunito:400,600,700,800|Roboto:400,500,700" rel="stylesheet">
  <!-- Theme CSS -->
  <link type="text/css" href="./assets/css/theme.css" rel="stylesheet">
  <!-- Demo CSS - No need to use these in your project -->
  <link type="text/css" href="./assets/css/demo.css" rel="stylesheet">
</head>

<body>
  <nav class="navbar navbar-expand-lg navbar-transparent navbar-dark bg-dark py-4">
    <div class="container">
      <a class="navbar-brand" href="./"><strong>DrawNet</strong> </a>
      <button class="navbar-toggler" type="button" data-action="offcanvas-open" data-target="#navbar_main"
        aria-controls="navbar_main" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="navbar-collapse offcanvas-collapse" id="navbar_main">
        <ul class="navbar-nav ml-auto align-items-lg-center">
          <div class="dropdown-divider d-lg-none my-4"></div>
          <h6 class="dropdown-header font-weight-600 d-lg-none px-0">Social Media</h6>
          <li class="nav-item">
            <a class="nav-link nav-link-icon" href="#" target="_blank"><i class="fab fa-instagram"></i><span
                class="ml-2 d-lg-none">Instagram</span></a>
          </li>
          <li class="nav-item">
            <a class="nav-link nav-link-icon" href="#" target="_blank"><i class="fab fa-facebook"></i><span
                class="ml-2 d-lg-none">Facebook</span></a>
          </li>
          <li class="nav-item">
            <a class="nav-link nav-link-icon" href="#" target="_blank"><i class="fab fa-dribbble"></i><span
                class="ml-2 d-lg-none">Dribbble</span></a>
          </li>
          <li class="nav-item">
            <a class="nav-link nav-link-icon" href="#" target="_blank"><i class="fab fa-github"></i><span
                class="ml-2 d-lg-none">Github</span></a>
          </li>
        </ul>
      </div>
    </div>
  </nav>
  <main class="main">
    <section class="spotlight parallax bg-cover bg-size--cover" data-spotlight="fullscreen"
      style="background-image: url('assets/images/top.png')">
      <!-- style="background-image: url('assets/images/backgrounds/img-1.jpg')" -->
      <span class="mask alpha-7" style="background-color:#b2b3a4;"></span>
      <div class="spotlight-holder py-lg pt-lg-xl">
        <div class="container d-flex align-items-center no-padding">
          <div class="col">
            <div class="row cols-xs-space align-items-center text-center text-md-left justify-content-center">
              <div class="col-7">
                <div class="text-center mt-5">
                  <!-- <img src="assets/images/brand/icon.png" style="width: 200px;" class="img-fluid animated" data-animation-in="jackInTheBox" data-animation-delay="1000"> -->
                  <h2 class="heading display-4 font-weight-400 text-white mt-5 animated" data-animation-in="fadeInUp"
                    data-animation-delay="2000">
                    <span class="font-weight-700">DrawNet: A neural painting network with attention module</span>
                  </h2>
                  <p class="lead text-white mt-3 lh-180 c-white animated" data-animation-in="fadeInUp"
                    data-animation-delay="2500">
                    Fachao Zhang <span><sup>a</sup></span>, Xiaoman Liang<sup>a,b,*</sup>, Yuan Qin<sup>a</sup>,Huihuang Zhao<sup>a,b</sup>
                  </p>

                  <p class="lead text-white mt-3 lh-180 c-white animated" data-animation-in="fadeInUp"
                    data-animation-delay="2500">
                    <sup>a</sup> College of Computer Science and Technology, Hengyang Normal University,
                    Hengyang,421002, China<strong class="text-white"></strong>
                  </p>

                  <p class="lead text-white mt-3 lh-180 c-white animated" data-animation-in="fadeInUp"
                    data-animation-delay="2500">
                    <sup>b</sup> Hunan Provincial Key Laboratory of Intelligent Information Processing and Application,
                    Hengyang, 421002, China<strong class="text-white"></strong>
                  </p>

                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
    <section class="slice slice-lg">

      <div class="container">

        <div class="row justify-content-center">

          <div class="col-lg-10">

            <!-- <h2 class="heading h3 mb-0">Demo</h2> -->
            <div style="margin-top: 10px;">
              <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" class="bi bi-github"
                viewBox="0 0 16 16">
                <path
                  d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z" />
              </svg> <span style="font-size: 16px;"><a href="#">[Code]</a></span>
            </div>
            <h2 class="heading h3 mb-0" style="margin-top: 10px;">Demo(.gif)</h2>
            <div class="row align-items-center mb-4">
              <div class="col-6">
                <img style="width: 100%;" src="assets/images/pandans_animated.mp4_20221227_154420.gif" />
              </div>
              <div class="col-6">
                <img style="width: 100%;" src="assets/images/sunflowers_animated.mp4_20221227_154715.gif" />
              </div>
              <div class="col-6">
                <img style="width: 100%;" src="assets/images/square_animated.mp4_20221227_154817.gif" />
              </div>
            </div>

            
            <h2 class="heading h3 mb-0">Demo(.png)</h2>
            <div class="row align-items-center mb-4">
              <div class="col-12">
                <img src="assets/images/img_result_.png" style="width: 100%;margin-top: 10px;">
                <p style="text-align: center; margin-top: 8px;font-weight: 700;padding-left: 50px;padding-right: 50px;">The result of our method of painting brush by brush with watercolor brushes (first row),
                  oilpaint brushes (second row) and markerpen brushes (third row).</p>
              </div>
              <hr style="width: 100%;margin-top: 5px;">
              <div class="col-6">
                <img src="assets/images/pandans_input.png" style="width: 100%;">
              </div>
              <div class="col-6">
                <img src="assets/images/pandans_final.png" style="width: 100%;">
              </div>
              
              <div class="col-6" style="margin-top: 10px;">
                <img src="assets/images/sunflowers_input.png" style="width: 100%;">
              </div>
              <div class="col-6" style="margin-top: 10px;">
                <img src="assets/images/sunflowers_final.png" style="width: 100%;">
              </div>


              <div class="col-6" style="margin-top: 10px;">
                <img src="assets/images/square_input.png" style="width: 100%;">
                <p style="text-align: center; margin-top: 8px;font-weight: 700;padding-left: 50px;padding-right: 50px;">input</p>
              </div>
              <div class="col-6" style="margin-top: 10px;">
                <img src="assets/images/square_final.png" style="width: 100%;">
                <p style="text-align: center; margin-top: 8px;font-weight: 700;padding-left: 50px;padding-right: 50px;">output</p>
              </div>

            </div>



            <!-- Typography -->
            <div class="row align-items-center mb-5">
              <div class="col-8">
                <h2 class="heading h3 mb-0">Abstract</h2>
              </div>
              <!-- <div class="col-4 text-right">
                <a href="docs/typography.html" class="btn btn-sm btn-primary">Open in Docs</a>
              </div> -->
            </div>
            <div class="row typeface-palette cols-xs-space cols-sm-space cols-md-space">
              <div class="col-sm-12">
                <p style="text-align:justify;text-indent:2em">In this paper, we propose a new image-to-painting
                  translation method that can generate paintings on a stroke by stroke basis. Unlike
                  previous pixel-to-pixel or sequential optimization methods, our method generates a set of physically
                  meaningful stroke parameters that can be
                  further rendered using a renderer. We add an attention mechanism network to the proposed renderer to
                  improve the quality of the painting images,
                  and use Smooth Ll loss in the training process of the renderer to make the model converge faster.
                  Experimental results show that our renderer
                  outperforms other renderers and improves the PSNR evaluation metric by 3.7% over the previous
                  renderer. Our code and more results are
                  available at <span><a
                      href="https://zhangfc7.github.io/DrawNet/">https://zhangfc7.github.io/DrawNet/</a></span>
                </p>
              </div>
            </div>
            <!-- Color palette -->
            <div class="row align-items-center mb-4 mt-lg">
              <div class="col-8">
                <h2 class="heading h3 mb-0">Method</h2>
              </div>
              <!-- <div class="col-4 text-right">
                <a href="docs/colors.html" class="btn btn-sm btn-primary">Open in Docs</a>
              </div> -->
            </div>

            <p style="text-indent: 2em;">The flowchart of our DrawNet is shown in Fig. 1. </p>
            <!-- <p>  When \(a \ne 0\), there are two solutions to \(ax^2 + bx + c = 0\) and they are
              \[x = {-b \pm \sqrt{b^2-4ac} \over 2a}.\]
            </p> -->
            
            <img src="assets/images/flow.png" style="width: 100%;" />
            <p style="text-align: center; margin-top: 8px;font-weight: 700;">Figure 1. Flow Chart</p>

            <div class="row align-items-center mb-4 mt-lg">
              <div class="col-8">
                <h2 class="heading h3 mb-0">Network</h2>
              </div>
            </div>
            <p style="text-indent: 2em;text-align: justify;">In this paper we propose a novel network named DrawNet, which consists of two convolutional neural networks: a Shading network, which 
              accepts color and shape parameters for generating foreground strokes with color, and a Rasteriztion network, which ignores stroke color and 
              generates clear stroke. The structure of DrawNet is shown in Figure 2.
              Shading network mainly consists of up-sampling, convolution, BatchNormal, ReLU activation function and other modules. The main 
              methods of upsampling are: transposed convolution, nearest neighbor interpolation, bilinear interpolation, etc. Although transposed convolution 
              has shown good results in many fields, the "tessellation effect" occurs if the convolution kernel size is not divisible by the step size [15]. In the 
              upsampling module of the Shading network we use bilinear interpolation, which does not need to learn any parameters, which speeds up the 
              computation of the model.The Rasteriztion network is mainly composed of fully connected, ReLU, convolution, and Pixel shuffle [16] modules, 
              and we add a fully connected layer followed by A MoblieVit2Attention module [17] was added after the fully connected layer and better output 
              was observed.
              </p>

            <img src="assets/images/network.png" style="width: 100%;" />
            <p style="text-align: center; margin-top: 8px;font-weight: 700;padding-left: 50px;padding-right: 50px;">
              Figure 2. The network structure of DrawNet, K is the kernel size, C is the number of feature maps, S is
              the step size in each convolutional layer,
              and M and N are the scaling factors.
            </p>

            <div class="row align-items-center mb-4 mt-lg">
              <div class="col-8">
                <h2 class="heading h3 mb-0">Experiments</h2>
              </div>
            </div>
            <p style="text-align:justify;text-indent: 2em;">We conducted our experiments on an Intel Core i7-12700 +
              Nvidia RTX3090 device,
              fixing the random seed values in all experiments. The optimizer uses Adam, we set epoch to 400, batchsize
              to 64, learning rate to 2e-4 and decay the learning rate to 0.1 every 100 epochs, so we can see from
              Figure 4 that the model converges significantly faster at epochs of 100, 200 and then stabilizes. The
              convergence rate of the model becomes faster and then stabilizes. In each epoch, we randomly generate
              50,000*64 ground truth images. The model converges after 400 epochs of training. We trained renderers for
              four types of strokes, namely oilpaint, watercolor, crayon, and markerpen. we compared our proposed
              renderer with those of other network structures and found that our renderer gave the best results. As
              shown in the figure below, our renderer has higher values of PSNR and SSIM than all the other four
              renderers, and also our renderer converges faster than all the other four renderers during the training
              process.</p>

            <img src="assets/images/val_psnr2.png" style="width: 100%;" />
            <p style="text-align: center; margin-top: 8px;font-weight: 700;">Figure 3. Variation curves of PSNR and SSIM during the training process</p>


            <div class="row align-items-center mb-4 mt-lg">
              <div class="col-8">
                <h2 class="heading h3 mb-0">Image-to-Painting Translation</h2>
              </div>
            </div>
            <p style="text-indent: 2em;"></p>

            <img src="assets/images/result.png" style="width: 100%;" />
            <p style="text-align: center; margin-top: 8px;font-weight: 700;">Figure 4.  Experimental results, (a): input (b): oilpaint (c): watercolor (d): markerpen (e): crayon</p>



            <div class="row align-items-center mb-4 mt-lg">
              <div class="col-8">
                <h2 class="heading h3 mb-0">Style Transfer</h2>
              </div>
            </div>
            <p style="text-indent: 2em;"></p>
            <img src="assets/images/style_transfer_result.png" style="width: 100%;" />
            <p style="text-align: center; margin-top: 8px;font-weight: 700;">Figure 5.  Style transfer results</p>
            
            <img src="assets/images/img_style_transfer_compare.png" style="width: 100%;" />
            <p style="text-align: center; margin-top: 8px;font-weight: 700;">Figure 6.  Style transfer results</p>

            <!-- <div class="row align-items-center mb-4 mt-lg">
              <div class="col-8">
                <h2 class="heading h3 mb-0">References</h2>
              </div>
            </div>

            <ul>
              <li>[1] Zou Z, Shi T, Qiu S, et al. Stylized neural painting[C].Proceedings of the IEEE/CVF Conference on
                Computer Vision and Pattern Recognition. 2021: 15689-15698.</li>
              <li>[2] Liu S, Lin T, He D, et al. Paint transformer: Feed forward neural painting with stroke
                prediction[C].Proceedings of the IEEE/CVF international conference on computer vision. 2021: 6598-6607.
              </li>
            </ul> -->

          </div>
        </div>
      </div>
    </section>
  </main>
  <footer class="pt-5 pb-3 footer  footer-dark bg-tertiary">
    <div class="container">
      <div class="row">
        <div class="col-12 col-md-4">
          <div class="pr-lg-5">
            <!-- <h1 class="heading h6 text-uppercase font-weight-700 mb-3"><strong>Boomerang</strong> UI Kit</h1>
            <p>Boomerang is a high quality UI Kit built on top of the well known Bootstrap 4 Framework. This theme was
              designed as its own extended version of Bootstrap with multiple functionalities and controls added,
              extended color palette and beautiful typography.</p> -->
          </div>
        </div>
        <div class="col-6 col-md">
          <!-- <h5 class="heading h6 text-uppercase font-weight-700 mb-3">Features</h5>
          <ul class="list-unstyled text-small">
            <li><a class="text-muted" href="#">Cool stuff</a></li>
            <li><a class="text-muted" href="#">Random feature</a></li>
            <li><a class="text-muted" href="#">Team feature</a></li>
            <li><a class="text-muted" href="#">Stuff for developers</a></li>
            <li><a class="text-muted" href="#">Another one</a></li>
            <li><a class="text-muted" href="#">Last time</a></li>
          </ul> -->
        </div>
        <div class="col-6 col-md">
          <!-- <h5 class="heading h6 text-uppercase font-weight-700 mb-3">Solutions</h5>
          <ul class="list-unstyled text-small">
            <li><a class="text-muted" href="#">Resource</a></li>
            <li><a class="text-muted" href="#">Resource name</a></li>
            <li><a class="text-muted" href="#">Another resource</a></li>
            <li><a class="text-muted" href="#">Final resource</a></li>
          </ul> -->
        </div>
        <div class="col-6 col-md">
          <!-- <h5 class="heading h6 text-uppercase font-weight-700 mb-3">Resources</h5>
          <ul class="list-unstyled text-small">
            <li><a class="text-muted" href="#">Business</a></li>
            <li><a class="text-muted" href="#">Education</a></li>
            <li><a class="text-muted" href="#">Government</a></li>
            <li><a class="text-muted" href="#">Gaming</a></li>
          </ul> -->
        </div>
        <div class="col-6 col-md">
          <!-- <h5 class="heading h6 text-uppercase font-weight-700 mb-3">About</h5>
          <ul class="list-unstyled text-small">
            <li><a class="text-muted" href="#">Team</a></li>
            <li><a class="text-muted" href="#">Locations</a></li>
            <li><a class="text-muted" href="#">Privacy</a></li>
            <li><a class="text-muted" href="#">Terms</a></li>
          </ul> -->
        </div>
      </div>
      <hr>
      <!-- <div class="d-flex align-items-center">
        <span class="">
          &copy; 2018 <a href="https://webpixels.io/" class="footer-link" target="_blank">Webpixels</a>. All rights
          reserved.
        </span>
        <ul class="nav ml-lg-auto">
          <li class="nav-item">
            <a class="nav-link active" href="https://instagram.com/webpixelsofficial" target="_blank"><i
                class="fab fa-instagram"></i></a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="https://facebook.com/webpixels" target="_blank"><i
                class="fab fa-facebook"></i></a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="https://github.com/webpixels" target="_blank"><i class="fab fa-github"></i></a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="https://dribbble.com/webpixels" target="_blank"><i
                class="fab fa-dribbble"></i></a>
          </li>
        </ul>
      </div> -->
    </div>
  </footer>
  <!-- Core -->
  <script src="./assets/vendor/jquery/jquery.min.js"></script>
  <script src="./assets/vendor/popper/popper.min.js"></script>
  <script src="./assets/js/bootstrap/bootstrap.min.js"></script>
  <!-- math -->
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
  </script>


  <!-- FontAwesome 5 -->
  <script src="./assets/vendor/fontawesome/js/fontawesome-all.min.js" defer></script>
  <!-- Page plugins -->
  <script src="./assets/vendor/bootstrap-select/js/bootstrap-select.min.js"></script>
  <script src="./assets/vendor/bootstrap-tagsinput/bootstrap-tagsinput.min.js"></script>
  <script src="./assets/vendor/input-mask/input-mask.min.js"></script>
  <script src="./assets/vendor/nouislider/js/nouislider.min.js"></script>
  <script src="./assets/vendor/textarea-autosize/textarea-autosize.min.js"></script>
  <!-- Theme JS -->
  <script src="./assets/js/theme.js"></script>
</body>

</html>